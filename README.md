# Проект "MyShop"

Для запуска приложения через Docker нужно скопировать docker-compose.yml из корневой дирректории проекта и выполнить команду docker-compose up --build.

Для запуска через терминал нужна запущенная СУБД Postgress c DB lightShopAPI.

CREATE DATABASE "lightShopApi"
    WITH  
    OWNER = postgres  
    ENCODING = 'UTF8'  
    LC_COLLATE = 'en_US.UTF-8'  
    LC_CTYPE = 'en_US.UTF-8'  
    TABLESPACE = pg_default  
    CONNECTION LIMIT = -1  
    IS_TEMPLATE = False;  

Приложение будет доступно по адресу http://localhost:8080/index.html. 

## Реализация модели онлайн магазина на основе Spring Boot  

### Технологии
- Java 17
- Spring Boot 3.2.5
- Spring Data JPA
- Spring Web
- Springdoc OpenAPI
- MapStruct
- Lombok

### API Documentation
Документация API доступна по адресу http://localhost:8080/swagger-ui/index.html

Таблицы
```
// Клиент
client
{
    id
    client_name
    client_surname
    birthday
    gender
    registration_date
    address_id
}
```
```
// Товар
product
{
    id
    name
    category
    price
    available_stock // число закупленных экземпляров товара
    last_update_date // число последней закупки
    supplier_id
    image_id: UUID
}
```
```
// Поставщики
supplier
{
    id
    name
    address_id
    phone_number
}
```
```
// Изображения товаров
images
{
    id : UUID
    image: bytea
}
```

```
// Адреса

address 
{
    id
    country
    city
    street
}

```

БД PostgreSQL. Реализация паттерна **Repository** в качестве прослойки доступа к данным.  
Для коммуникации с API использован DTO (Data Transfer Objects), для преобразования DTO в модель и обратно MapStruct.   
API спроектирован по [RESTFUL](https://restfulapi.net/) методологии. Реализованны популярные виды HTTP запросов (GET, POST, PUT, DELETE, PATCH).

- Для клиентов:
    
    1) Добавление клиента (на вход подается json, соответствующей структуре, описанной сверху).

    2) Удаление клиента (по его идентификатору)

    3) Получение клиентов по имени и фамилии (параметры - имя и фамилия)

    4) Получение всех клиентов (с опциональными параметрами пагинации в строке запроса: limit и offset). В случае отсутствия этих параметров будет возвращаться весь список.

    5) Изменение адреса клиента (параметры: Id и новый адрес в виде json в соответствии с выше описанным форматом)

- Для товаров:

    1) Добавление товара (на вход подается json, соответствующей структуре, описанной сверху).

    2) Уменьшение количества товара (на вход запросу подается id товара и на сколько уменьшить)

    3) Получение товара по id

    4) Получение всех доступных товаров

    5) Удаление товара по id

- Для поставщиков:

    1) Добавление поставщика (на вход подается json, соответствующей структуре, описанной сверху).

    2) Изменение адреса поставщика (параметры: Id и новый адрес в виде json в соответствии с выше описанным форматом)

    3) Удаление поставщика по id

    4) Получение всех поставщиков

    5) Получение поставщика по id

- Для изображений:

    1) добавление изображения (на вход подается byte array изображения и id товара).

    2) Изменение изображения (на вход подается id изображения и новая строка для замены)

    3) Удаление изображения по id изображения

    4) Получение изображения конкретного товара (по id товара) 
   
    5) Получение изображения по id изображения

Методы, возвращающие изображение, возвращают изображение (массив байт) с заголовком «application/octet-stream». При этом файлы подгружаются автоматически.

Для каждого из описанных запросов выше, если предусмотрено получение данных в теле на вход, будет проведена валидация данных и в случае, если валидация прошла неуспешно - выдан 400 код ошибки с текстом сообщения.

Если запрос предусматривает обновление данных или получение по Id, в случае отсутствия данных вернется код ошибки 404 с текстом сообщения.

Если запрос предусматривает возврат списка данных, то в случае отсутствия данных возвращается пустой список.


